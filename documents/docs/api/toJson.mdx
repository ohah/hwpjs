import { PlatformTabs } from '../../components/PlatformTabs';

# toJson

HWP 파일을 JSON 형식으로 변환하는 함수입니다.

## 예제

<PlatformTabs defaultPlatform="web">
  <div data-platform="web">
    ```typescript
    // buffer-polyfill을 먼저 import한 후
    import * as hwpjs from '@ohah/hwpjs';

    // 파일 입력에서 HWP 파일 읽기
    const fileInput = document.querySelector('input[type="file"]');
    fileInput.addEventListener('change', async (e) => {
      const file = (e.target as HTMLInputElement).files?.[0];
      if (!file) return;

      try {
        const arrayBuffer = await file.arrayBuffer();
        const data = new Uint8Array(arrayBuffer);

        // JSON으로 변환
        const jsonResult = hwpjs.toJson(data);
        console.log(jsonResult);
      } catch (error) {
        console.error('변환 실패:', error);
      }
    });
    ```
  </div>

  <div data-platform="react-native">
    ```typescript
    import { Hwpjs } from '@ohah/hwpjs';
    import RNFS from 'react-native-fs';
    import { Platform } from 'react-native';

    try {
      // 파일 경로 설정
      const filePath = Platform.OS === 'ios' 
        ? `${RNFS.MainBundlePath}/document.hwp`
        : `${RNFS.DocumentDirectoryPath}/document.hwp`;

      // 파일을 base64로 읽기
      const fileData = await RNFS.readFile(filePath, 'base64');

      // base64를 ArrayBuffer로 변환
      const binaryString = atob(fileData);
      const length = binaryString.length;
      const bytes = new Uint8Array(length);
      for (let i = 0; i < length; i++) {
        bytes[i] = binaryString.charCodeAt(i);
      }

      // HWP 파일 파싱 (ArrayBuffer 직접 사용)
      const result = Hwpjs.toJson(bytes.buffer);
      console.log(result);
    } catch (error) {
      console.error('변환 실패:', error);
    }
    ```
  </div>

  <div data-platform="node">
    ```typescript
    import { readFileSync } from 'fs';
    import { toJson } from '@ohah/hwpjs';

    try {
      const fileBuffer = readFileSync('./document.hwp');
      const result = toJson(fileBuffer);
      console.log(result);
    } catch (error) {
      console.error('변환 실패:', error);
    }
    ```
  </div>
</PlatformTabs>

## 시그니처

```typescript
function toJson(data: Buffer): string
```

## 매개변수

### `data: Buffer`

변환할 HWP 파일의 바이트 배열입니다 (Buffer 또는 Uint8Array).

**예제:**
```typescript
import { readFileSync } from 'fs';
const fileBuffer = readFileSync('./document.hwp');
const data = new Uint8Array(fileBuffer);
```

## 반환값

### `string`

변환된 HWP 문서의 JSON 문자열입니다.

## 에러

HWP 파일 형식이 올바르지 않거나 변환에 실패한 경우 에러가 발생합니다.

- HWP 파일 형식이 올바르지 않은 경우
- 파일이 손상된 경우
- JSON 직렬화에 실패한 경우

## 참고

이 함수는 Rust로 구현된 `hwp-core` 라이브러리를 사용하여 HWP 파일을 파싱하고 JSON으로 변환합니다.
