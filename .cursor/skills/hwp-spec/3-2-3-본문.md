# 3.2.3. 본문

문서의 본문에 해당하는 문단, 표, 그리기 개체 등의 내용이 저장되는 곳이다.

`BodyText` 스토리지는 `Section%d` 스트림으로 나뉘며, `%d`는 구역 번호를 나타낸다. 구역의 개수는 문서 정보의 문서 속성에 저장된다.

각 구역의 첫 번째 문단에는 구역 정의 레코드가 저장되고, 각 단 설정의 첫 번째 문단에는 단 정의 레코드가 저장된다.

각 구역의 가장 마지막에는 확장 기본 쪽(마지막 쪽, 임의 쪽) 관련 정보가 저장되고, 마지막 구역의 가장 마지막에는 메모 관련 정보가 저장된다.

`Section` 스트림에 저장되는 데이터는 문단(문단의 리스트)으로 구성되며, 다음 문단 정보가 반복된다.

**표 5: 본문**

| Tag ID | 길이(바이트) | 레벨 | 설명 |
|---|---|---|---|
| HWPTAG_PARA_HEADER | 22 | 0 | 문단 헤더(표 58 참조) |
| HWPTAG_PARA_TEXT | 가변 | 1 | 문단의 텍스트(표 60 참조) |
| HWPTAG_PARA_CHAR_SHAPE | 가변 | 1 | 문단의 글자 모양(표 61 참조) |
| HWPTAG_PARA_LINE_SEG | 가변 | 1 | 문단의 레이아웃 |
| HWPTAG_PARA_RANGE_TAG | 가변 | 1 | 문단의 영역 태그 |
| HWPTAG_CTRL_HEADER | 가변 | 1 | 컨트롤 헤더 |
| HWPTAG_LIST_HEADER | 가변 | 1 | 문단 리스트 헤더 |
| HWPTAG_PAGE_DEF | 가변 | 1 | 용지 설정 |
| HWPTAG_FOOTNOTE_SHAPE | 가변 | 1 | 각주/미주 모양 |
| HWPTAG_PAGE_BORDER_FILL | 가변 | 1 | 쪽 테두리/배경 |
| HWPTAG_SHAPE_COMPONENT | 가변 | 1 | 개체 |
| HWPTAG_TABLE | 가변 | 1 | 표 개체 |
| HWPTAG_SHAPE_COMPONENT_LINE | 가변 | 1 | 직선 개체 |
| HWPTAG_SHAPE_COMPONENT_RECTANGLE | 가변 | 1 | 사각형 개체 |
| HWPTAG_SHAPE_COMPONENT_ELLIPSE | 가변 | 1 | 타원 개체 |
| HWPTAG_SHAPE_COMPONENT_ARC | 가변 | 1 | 호 개체 |
| HWPTAG_SHAPE_COMPONENT_POLYGON | 가변 | 1 | 다각형 개체 |
| HWPTAG_SHAPE_COMPONENT_CURVE | 가변 | 1 | 곡선 개체 |
| HWPTAG_SHAPE_COMPONENT_OLE | 가변 | 1 | OLE 개체 |
| HWPTAG_SHAPE_COMPONENT_PICTURE | 가변 | 1 | 그림 개체 |
| HWPTAG_SHAPE_COMPONENT_CONTAINER | 가변 | 1 | 컨테이너 개체 |
| HWPTAG_CTRL_DATA | 가변 | 1 | 컨트롤 임의의 데이터 |
| HWPTAG_EQEDIT | 가변 | 1 | 수식 개체 |
| RESERVED | 가변 | 1 | 예약 |
| HWPTAG_SHAPE_COMPONENT_TEXTART | 가변 | 1 | 글맵시 |
| HWPTAG_FORM_OBJECT | 가변 | 1 | 양식 개체 |
| HWPTAG_MEMO_SHAPE | 가변 | 1 | 메모 모양 |
| HWPTAG_MEMO_LIST | 가변 | 1 | 메모 리스트 헤더 |
| HWPTAG_CHART_DATA | 가변 | 1 | 차트 데이터 |
| HWPTAG_VIDEO_DATA | 가변 | 1 | 비디오 데이터 |
| HWPTAG_SHAPE_COMPONENT_UNKNOWN | 36 | 1 | Unknown |
| 전체 길이 | 가변 | | |

문서 파일에서 문단 내용을 읽다가 제어 문자를 발견하면, 문서를 읽는 쪽에서는 제어 문자 종류에 따라 읽어 들이거나 건너 뛰어 다음 데이터의 시작 위치까지 파일 포인터를 옮기기 위한 적절한 처리를 수행해야 한다. 제어 문자 가운데는 또 다른 문단 리스트를 포함하는 경우도 있기 때문에, 제어 문자를 일반 문자처럼 처리하면 문서 파일을 정상적으로 읽을 수 없다.

표, 각주 등과 같은 문단 리스트를 포함하는 컨트롤 문자들은 독자적인 문단 리스트를 가진다. 해당 리스트들은 아래와 같은 리스트 헤더 정보를 포함한다. 실제 문단들은 그 다음에 serialize 된다.

문단 내에서 컨트롤은 세 가지 형식에 따라 다음과 같은 차이가 있다.

**문자 컨트롤**

부가정보 없이 문자 하나로 표현되는 제어 문자이다. (3번째 ch)

| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |
|---|---|---|---|---|---|---|---|---|---|---|---|
| 'A' | 'B' | 'C' | ch | 'D' | 'E' | 'F' | 'G' | 'H' | 'I' | 'J' | 13 |

**인라인 컨트롤**

부가정보가 12 바이트(6 WCHAR) 이내에서 표현될 수 있는 제어 문자이다. info에 부가정보를 다 넣지 못하는 경우는 확장 컨트롤로 대체된다. (3~9까지 8개의 ch)

| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |
|---|---|---|---|---|---|---|---|---|---|---|---|
| 'A' | 'B' | ch | info (6바이트) | info | info | info | info | info | ch | 'C' | 13 |

**확장 컨트롤**

제어 문자는 포인터를 가지고 있고, 포인터가 가리키는 곳에 실제 오브젝트가 존재하는 제어 문자이다. (3~9까지 8개의 ch)

| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |
|---|---|---|---|---|---|---|---|---|---|---|---|
| 'A' | 'B' | ch | pointer (6바이트) | pointer | pointer | pointer | pointer | pointer | ch | 'C' | 13 |

↓ (포인터가 가리키는 위치)

Control Object Instance

본 문서에 부가 설명 없이 '컨트롤' 또는 '제어 문자'라고 하면 바로 이 확장 컨트롤을 지칭하는 것이다.

**표 6: 제어 문자**

| 코드 | 설명 | 제어 문자 유형 |
|---|---|---|
| 4 | 필드 끝 | inline |
| 5-7 | 예약 | inline |
| 8 | title mark | inline |
| 9 | 탭 | inline |
| 10 | 한 줄 끝(line break) | char |
| 11 | 그리기 개체/표 | extended |
| 12 | 예약 | extended |
| 13 | 문단 끝(para break) | char |
| 14 | 예약 | extended |
| 15 | 숨은 설명 | extended |
| 16 | 머리말/꼬리말 | extended |
| 17 | 각주/미주 | extended |
| 18 | 자동번호(각주, 표 등) | extended |
| 19-20 | 예약 | inline |
| 21 | 페이지 컨트롤(감추기, 새 번호로 시작 등) | extended |
| 22 | 책갈피/찾아보기 표식 | extended |
| 23 | 덧말/글자 겹침 | extended |
| 24 | 하이픈 | char |
| 25-29 | 예약 | char |
| 30 | 묶음 빈칸 | char |
| 31 | 고정폭 빈칸 | char |
