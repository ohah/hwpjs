# 4.3.9.4. 그림 개체

Tag ID: HWPTAG_SHAPE_COMPONENT_PICTURE

---

## 구현 참고사항 (Implementation Notes)

### 레벨 정보 (Level Information)

스펙 문서 표 5에서는 HWPTAG_SHAPE_COMPONENT와 HWPTAG_SHAPE_COMPONENT_PICTURE 모두 **레벨 1**로 표시되어 있다. 하지만 **실제 HWP 파일에서는 두 가지 경우가 모두 가능**하다.

1. **레벨 1 (형제 관계)**: SHAPE_COMPONENT와 SHAPE_COMPONENT_PICTURE가 같은 레벨 형제로 나타나는 경우
2. **레벨 3 (부모-자식 관계)**: SHAPE_COMPONENT_PICTURE가 SHAPE_COMPONENT의 자식(level 3)으로 파싱되는 경우

이는 표 106에서 SHAPE_COMPONENT_PICTURE가 SHAPE_COMPONENT와 동일한 "개체 요소 공통 속성(표 83)"을 포함하기 때문에, 실제 바이너리 구조에서 SHAPE_COMPONENT_PICTURE가 SHAPE_COMPONENT의 자식으로 중첩될 수 있기 때문이다.

### 파서 구현 (Parser Implementation)

파서 구현 시 **SHAPE_COMPONENT의 children을 재귀적으로 처리**하도록 구현해야 한다. SHAPE_COMPONENT에 `children` 필드를 추가하여, SHAPE_COMPONENT_PICTURE가 자식으로 올 경우 이를 포함할 수 있도록 해야 한다. 이렇게 하면 레벨 1과 레벨 3 두 경우 모두 올바르게 처리할 수 있다.

---

**표 106: 그림 개체** — 개체 공통(표 68) + 개체 요소 공통(표 83) + 그림 개체 속성(표 107).

**표 107: 그림 개체 속성**

| 자료형 | 길이(바이트) | 설명 |
|---|---|---|
| COLORREF | 4 | 테두리 색 |
| INT32 | 4 | 테두리 두께 |
| UINT32 | 4 | 테두리 속성(표 87) |
| INT32 array[4] | 16 | 이미지 테두리 사각형 x(최초 크기) |
| INT32 array[4] | 16 | 이미지 테두리 사각형 y |
| INT32×4 | 16 | 자르기 후 left, top, right, bottom |
| BYTE stream | 8 | 안쪽 여백(표 77) |
| BYTE stream | 5 | 그림 정보(표 32) |
| BYTE | 1 | 테두리 투명도 |
| UINT32 | 4 | instance ID |
| BYTE stream | n | 그림 효과(표 108) |
| 전체 길이 | 가변 | 78+n |

**표 108: 그림 효과** — UINT32 효과 정보 + 각 효과(표 109~113). **표 109**: 그림자(스타일, 투명도, 흐림, 방향, 거리 등). **표 110**: 네온. **표 111**: 부드러운 가장자리. **표 112**: 반사. **표 113**: 색상 속성. **표 114**: 색상 효과. **표 115**: 색상 효과 종류. **표 116: 그림 추가 속성** — HWPUNIT 8 최초 이미지 크기, INT8 1 투명도. 전체 9.
