# 3.2.11. 문서 이력 관리

한글 메뉴의 "파일 - 문서 이력 관리"에서 표시 및 생성되는 문서의 이력 정보를 저장하는 장소이다.

문서 이력 정보의 각각의 아이템은 "히스토리" 혹은 "히스토리 아이템"이라 하며 한글 Compound 구조 내에서 각 아이템은 "DocHistory"라는 스토리지 내부에 VersionLog%d(%d는 버전) 이름의 스트림으로 저장된다. 또한, 각각 아이템은 압축, 암호화되어 저장된다.

이력 정보 데이터를 "DocHistory"라는 새로운 스토리지로 저장한다. DocHistory 스토리지에 이력 정보 아이템은 추후 추가 정보가 저장되었을 때 하위 호환성을 위하여 다음의 구조로 저장한다.

**버전 정보 스토리지 구조:**

```
DocHistory : 스토리지
├── VersionLog0 : 이력 정보 스트림
├── VersionLog1 : 이력 정보 스트림
├── VersionLog2 : 이력 정보 스트림
├── ...
└── HistoryLastDoc : 최종문서 스트림
```

**히스토리 아이템 스트림 구조:**

```
히스토리 아이템
├── 아이템 시작 레코드
├── 히스토리 정보 레코드 1
├── 히스토리 정보 레코드 2
├── 히스토리 정보 레코드 3
├── ...
├── (사용자, 시간, 날짜 등...)
├── 이력 정보 데이터 레코드
└── 아이템 끝 레코드
```

**레코드 구성:**

**RECORD_HEADER**

| 자료형 | 설명 |
|---|---|
| BYTE | 레코드 Type |
| UINT | 추가 데이터 블록 (RD) BYTE 크기 |

**RECORD_DATA (RD)**

| 자료형 | 설명 |
|---|---|
| DATA | 레코드 Type에 따른 다양한 정보 (스트링, Bit flag 등) |
